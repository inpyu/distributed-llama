<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="700" viewBox="0 0 1200 700">
  <style>
    .title { font: 700 22px sans-serif; }
    .section { font: 700 16px sans-serif; }
    .label { font: 14px sans-serif; }
    .small { font: 12px sans-serif; }
    .box { fill: none; stroke: #222; stroke-width: 2; }
    .dash { stroke: #777; stroke-width: 2; stroke-dasharray: 6 6; }
  </style>

  <text x="600" y="40" text-anchor="middle" class="title">현재 분할 방식 요약 (Tensor Parallelism)</text>

  <!-- Row Matmul section -->
  <text x="300" y="90" text-anchor="middle" class="section">Row Matmul (출력 차원 분할)</text>

  <rect x="60" y="110" width="500" height="60" class="box" />
  <text x="310" y="145" text-anchor="middle" class="label">입력 X: [n, dim]</text>

  <rect x="640" y="110" width="500" height="60" class="box" />
  <text x="890" y="145" text-anchor="middle" class="label">가중치 W: [dim, d]</text>

  <!-- Row Matmul outputs per node -->
  <rect x="60" y="210" width="230" height="60" class="box" />
  <text x="175" y="245" text-anchor="middle" class="small">노드0: [n, d/4]</text>

  <rect x="330" y="210" width="230" height="60" class="box" />
  <text x="445" y="245" text-anchor="middle" class="small">노드1: [n, d/4]</text>

  <rect x="600" y="210" width="230" height="60" class="box" />
  <text x="715" y="245" text-anchor="middle" class="small">노드2: [n, d/4]</text>

  <rect x="870" y="210" width="230" height="60" class="box" />
  <text x="985" y="245" text-anchor="middle" class="small">노드3: [n, d/4]</text>

  <text x="600" y="300" text-anchor="middle" class="small">All-Gather → 전체 출력 [n, d]</text>

  <!-- Divider -->
  <line x1="60" y1="330" x2="1140" y2="330" class="dash" />

  <!-- Col Matmul section -->
  <text x="300" y="380" text-anchor="middle" class="section">Col Matmul (입력 차원 분할)</text>

  <!-- Col Matmul inputs per node -->
  <rect x="60" y="410" width="230" height="60" class="box" />
  <text x="175" y="445" text-anchor="middle" class="small">노드0: [n/4, d]</text>

  <rect x="330" y="410" width="230" height="60" class="box" />
  <text x="445" y="445" text-anchor="middle" class="small">노드1: [n/4, d]</text>

  <rect x="600" y="410" width="230" height="60" class="box" />
  <text x="715" y="445" text-anchor="middle" class="small">노드2: [n/4, d]</text>

  <rect x="870" y="410" width="230" height="60" class="box" />
  <text x="985" y="445" text-anchor="middle" class="small">노드3: [n/4, d]</text>

  <rect x="640" y="500" width="500" height="60" class="box" />
  <text x="890" y="535" text-anchor="middle" class="label">가중치 W: [n, d]</text>

  <text x="600" y="610" text-anchor="middle" class="small">All-Reduce → 합산 결과 [d]</text>
</svg>
